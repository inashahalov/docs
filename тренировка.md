

### ‚úÖ –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Window Functions) ‚Äî –∫—Ä–∞—Ç–∫–æ, –ø–æ –¥–µ–ª—É

**–ß—Ç–æ —ç—Ç–æ?**  
–§—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å—á–∏—Ç–∞—é—Ç —á—Ç–æ-—Ç–æ **–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≥—Ä—É–ø–ø—ã —Å—Ç—Ä–æ–∫**, –Ω–µ —Å–∂–∏–º–∞—è –∏—Ö –≤ –æ–¥–Ω—É (–∫–∞–∫ GROUP BY).  
–ü—Ä–∏–º–µ—Ä: *¬´–ü–æ–∫–∞–∂–∏ –∫–∞–∂–¥—É—é –ø—Ä–æ–¥–∞–∂—É + —Å—Ä–µ–¥–Ω—é—é —Å—É–º–º—É –ø–æ –∫–ª–∏–µ–Ω—Ç—É –∑–∞ –º–µ—Å—è—Ü¬ª* ‚Äî –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏.

**–ë–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:**
```sql
SELECT 
  column1,
  column2,
  FUNCTION(column) OVER (
    PARTITION BY group_column
    ORDER BY sort_column
    ROWS BETWEEN ... -- –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
  ) AS alias
FROM table;
```

**–ö–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
- `PARTITION BY` ‚Äî –∫–∞–∫ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å (–∞–Ω–∞–ª–æ–≥ GROUP BY, –Ω–æ —Å—Ç—Ä–æ–∫–∏ –Ω–µ —Å—Ö–ª–æ–ø—ã–≤–∞—é—Ç—Å—è)
- `ORDER BY` ‚Äî –ø–æ—Ä—è–¥–æ–∫ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è —Ä–∞–Ω–∂–∏—Ä—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π)
- `ROWS BETWEEN ...` ‚Äî –æ–∫–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å—Ç—Ä–æ–∫–∏)

**–°–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
| –§—É–Ω–∫—Ü–∏—è | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ü—Ä–∏–º–µ—Ä |
|--------|------------|--------|
| `ROW_NUMBER()` | –ù—É–º–µ—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫–∏ –≤ –≥—Ä—É–ø–ø–µ | `ROW_NUMBER() OVER (PARTITION BY client_id ORDER BY order_date)` ‚Äî –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–∞ |
| `RANK()` / `DENSE_RANK()` | –†–∞–Ω–∂–∏—Ä—É–µ—Ç —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ / –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ | `RANK() OVER (ORDER BY sales DESC)` ‚Äî —Ç–æ–ø-10 –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ |
| `SUM() OVER()` | –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ | `SUM(amount) OVER (ORDER BY date ROWS UNBOUNDED PRECEDING)` ‚Äî –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ |
| `LAG()` / `LEAD()` | –ó–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π/—Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏ | `LAG(sales, 1) OVER (ORDER BY month)` ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª—ã–º –º–µ—Å—è—Ü–µ–º |
| `AVG() OVER()` | –°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ | `AVG(revenue) OVER (ORDER BY date ROWS 6 PRECEDING)` ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é |

**–¢—ã –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å –Ω–∞–ø–∏—Å–∞—Ç—å —ç—Ç–æ –Ω–∞ –¥–æ—Å–∫–µ –±–µ–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫. –ë–µ–∑ –∑–∞–¥—É–º–∫–∏. –ó–∞ 2 –º–∏–Ω—É—Ç—ã.**

---

### ‚úÖ JOIN ‚Äî –≤–∏–¥—ã, –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ —Å—É—Ç–∏

| –¢–∏–ø JOIN | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|----------|-------------|---------------------|
| `INNER JOIN` | –¢–æ–ª—å–∫–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ –∑–∞–ø–∏—Å–∏ | ¬´–ü–æ–∫–∞–∂–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –∑–∞–∫–∞–∑—ã¬ª |
| `LEFT JOIN` | –í—Å–µ –∏–∑ –ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü—ã + —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–∑ –ø—Ä–∞–≤–æ–π | ¬´–ü–æ–∫–∞–∂–∏ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –∑–∞–∫–∞–∑—ã–≤–∞–ª–∏¬ª |
| `RIGHT JOIN` | –í—Å–µ –∏–∑ –ø—Ä–∞–≤–æ–π + —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–∑ –ª–µ–≤–æ–π | –†–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–ª—É—á—à–µ –ø–æ–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—ã –º–µ—Å—Ç–∞–º–∏) |
| `FULL OUTER JOIN` | –í—Å–µ –∏–∑ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü | ¬´–ü–æ–∫–∞–∂–∏ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –≤—Å–µ—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ—Ç —Å–≤—è–∑–µ–π¬ª |
| `CROSS JOIN` | –î–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ ‚Äî **–∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞**, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ | ¬´–í—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤¬ª ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö |

**–¢–≤–æ—è –≥–ª–∞–≤–Ω–∞—è –æ—à–∏–±–∫–∞:**  
–¢—ã –≥–æ–≤–æ—Ä–∏—à—å ¬´—è –∑–Ω–∞—é JOIN¬ª, –Ω–æ –∫–æ–≥–¥–∞ —Ç–µ–±—è —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç:  
> *¬´–£ –Ω–∞—Å –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ clients –∏ orders. –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞¬ª* ‚Äî —Ç—ã **–∑–∞–ø–∏–Ω–∞–µ—à—å—Å—è**.

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```sql
SELECT c.client_id, c.name
FROM clients c
LEFT JOIN orders o ON c.client_id = o.client_id 
  AND o.order_date >= CURRENT_DATE - INTERVAL '3 months'
WHERE o.client_id IS NULL;
```

–≠—Ç–æ ‚Äî **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å –Ω–∞ 90% —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–π**.  
–¢—ã –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –Ω–µ–≥–æ **–≤ 5 —Å–µ–∫—É–Ω–¥**. –ë–µ–∑ –¥—Ä–æ–∂–∏ –≤ —Ä—É–∫–∞—Ö. –ë–µ–∑ –º—ã—Å–ª–µ–π ¬´–∞ –≤–¥—Ä—É–≥ —è –æ—à–∏–±—Å—è¬ª.

---

### üí• –ß—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å –Ω–µ —Ç–∞–∫?

1. **–¢—ã —É—á–∏—à—å—Å—è –∫–∞–∫ —Å—Ç—É–¥–µ–Ω—Ç, –∞ –Ω–µ –∫–∞–∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∂–∏–≤–∞–µ—Ç.**  
   –¢—ã —á–∏—Ç–∞–µ—à—å –∫—É—Ä—Å—ã, —Å–º–æ—Ç—Ä–∏—à—å –≤–∏–¥–µ–æ ‚Äî –Ω–æ –Ω–µ **–æ—Ç—Ä–∞–±–∞—Ç—ã–≤–∞–µ—à—å –¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–º–∞**.  
   –¢—ã –Ω–µ –ø–∏—à–µ—à—å 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å. –¢—ã –Ω–µ —Ä–µ—à–∞–µ—à—å –∑–∞–¥–∞—á–∏ –Ω–∞ LeetCode/HackerRank/SQLZoo **–µ–∂–µ–¥–Ω–µ–≤–Ω–æ**.  
   –¢—ã –Ω–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å—Å—è –ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º ‚Äî –∞ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ —Ç—ã **–ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º**.  
   –¢—ã –Ω–µ –ø–∏—à–µ—à—å SQL **–æ—Ç —Ä—É–∫–∏**. –¢—ã –Ω–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å—Å—è –±–µ–∑ IDE.

2. **–¢—ã –±–æ–∏—à—å—Å—è –æ—à–∏–±–∏—Ç—å—Å—è ‚Äî –∏ –ø–æ—ç—Ç–æ–º—É –Ω–µ –ø—Ä–∞–∫—Ç–∏–∫—É–µ—à—å.**  
   –≠—Ç–æ –°–î–í–ì. –≠—Ç–æ –†–°. –≠—Ç–æ –≤—ã–≥–æ—Ä–∞–Ω–∏–µ. –ù–æ **—ç—Ç–æ –Ω–µ –æ–ø—Ä–∞–≤–¥–∞–Ω–∏–µ**.  
   –¢—ã ‚Äî –æ—Ç–µ—Ü —Ç—Ä–æ–∏—Ö –¥–µ—Ç–µ–π. –¢—ã –Ω–µ –º–æ–∂–µ—à—å –ø–æ–∑–≤–æ–ª–∏—Ç—å —Å–µ–±–µ ¬´–ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ¬ª.  
   –¢–≤–æ—è —Å–µ–º—å—è –∂–¥—ë—Ç. –¢—ã –Ω–µ –º–æ–∂–µ—à—å –∂–¥–∞—Ç—å ¬´–∫–æ–≥–¥–∞ —Å—Ç–∞–Ω–µ—Ç –ª–µ–≥—á–µ¬ª.  
   **–õ–µ–≥—á–µ –Ω–µ –±—É–¥–µ—Ç. –¢—ã –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å —Å–∏–ª—å–Ω–µ–µ ‚Äî –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å.**

3. **–¢—ã –Ω–∞–∑—ã–≤–∞–µ—à—å —Å–µ–±—è ¬´–∫–∞–ø–∏—Ç–∞–Ω–æ–º –∫–æ–º–∞–Ω–¥—ã¬ª ‚Äî –Ω–æ –Ω–µ –º–æ–∂–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±–æ–π.**  
   –¢—ã —É–ø—Ä–∞–≤–ª—è–µ—à—å –¥—Ä—É–≥–∏–º–∏ –≤ —Ö–∞–∫–∞—Ç–æ–Ω–∞—Ö ‚Äî –∞ —Å–∞–º –Ω–µ –º–æ–∂–µ—à—å –∑–∞—Å—Ç–∞–≤–∏—Ç—å —Å–µ–±—è –ø—Ä–æ–π—Ç–∏ 10 –∑–∞–¥–∞—á –ø–æ –æ–∫–æ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º.  
   –≠—Ç–æ –Ω–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–µ—Ñ–∏—Ü–∏—Ç. –≠—Ç–æ **–¥–µ—Ñ–∏—Ü–∏—Ç –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã**.  
   –ò –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ ‚Äî —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–±–µ–¥–∏—Ç—å –†–°, –°–î–í–ì –∏ 17 –ª–µ—Ç –≤ IT, –∫–æ–≥–¥–∞ —Ç—ã –ø–æ—Ç–µ—Ä—è–ª —Å–µ–±—è.

---

### üö® –¢–≤–æ–π –ø–ª–∞–Ω –Ω–∞ 7 –¥–Ω–µ–π (–±–µ–∑ –∏–∑–≤–∏–Ω–µ–Ω–∏–π)

| –î–µ–Ω—å | –ó–∞–¥–∞—á–∞ | –ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞ |
|------|--------|------------------|
| 1 | –ù–∞–ø–∏—à–∏ 5 –∑–∞–ø—Ä–æ—Å–æ–≤ —Å `ROW_NUMBER()`, `RANK()`, `LAG()` –Ω–∞ SQLZoo –∏–ª–∏ LeetCode | –ë–µ–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫. –ë–µ–∑ –∑–∞–ø—É—Å–∫–∞. –ü–∏—à–∏ –æ—Ç —Ä—É–∫–∏. |
| 2 | –†–µ—à–∏ 3 –∑–∞–¥–∞—á–∏: ¬´–Ω–∞–π—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ –∑–∞–∫–∞–∑–æ–≤¬ª, ¬´—Ç–æ–ø-3 –ø–æ —Å—É–º–º–µ –∑–∞ –º–µ—Å—è—Ü¬ª, ¬´—Å—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π¬ª | –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å ‚Äî 2 –º–∏–Ω—É—Ç—ã. –ï—Å–ª–∏ –¥–æ–ª—å—à–µ ‚Äî –ø–æ–≤—Ç–æ—Ä–∏. |
| 3 | –í—ã—É—á–∏ –Ω–∞–∏–∑—É—Å—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ 4 —Ç–∏–ø–∞ JOIN | –ó–∞–ø–∏—à–∏ –∏—Ö –Ω–∞ –ª–∏—Å—Ç–æ–∫. –ü–æ–≤—Ç–æ—Ä–∏ —É—Ç—Ä–æ–º –∏ –≤–µ—á–µ—Ä–æ–º. |
| 4 | –ü—Ä–æ–π–¥–∏ 3 —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ ¬´—Ç–æ–ª—å–∫–æ SQL¬ª ‚Äî –Ω–∞ YouTube, –≤–∂–∏–≤—É—é —Å –¥—Ä—É–≥–æ–º | –ó–∞–ø–∏—à–∏ —Å–µ–±—è. –ü–æ—Å–º–æ—Ç—Ä–∏. –£–≤–∏–¥–∏—à—å, –∫–∞–∫ —Ç—ã –∑–∞–ø–∏–Ω–∞–µ—à—å—Å—è. |
| 5 | –ù–∞–ø–∏—à–∏ 1 —Å–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å: ¬´–Ω–∞–π—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, —á—å—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫ –≤—ã—Ä–æ—Å–ª–∞ –Ω–∞ 20% –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—à–ª–æ–≥–æ –º–µ—Å—è—Ü–∞¬ª | –ë–µ–∑ –≥—É–≥–ª–∞. –¢–æ–ª—å–∫–æ –∑–Ω–∞–Ω–∏—è. |
| 6 | –ü–æ–≤—Ç–æ—Ä–∏ –≤—Å—ë. –ó–∞–ø–∏—à–∏ –≤–∏–¥–µ–æ: ¬´–Ø, –ò–ª—å—è, Data Engineer. –Ø –∑–Ω–∞—é –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ JOIN¬ª. –û—Ç–ø—Ä–∞–≤—å –µ–≥–æ —Å–µ–±–µ. | –ü—Ä–æ—á–∏—Ç–∞–π –≤—Å–ª—É—Ö. –ù–µ —Å–º–æ—Ç—Ä–∏ –≤ –∫–∞–º–µ—Ä—É. –ü—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏. |
| 7 | **–°–¥–µ–ª–∞–π —Ç–æ –∂–µ —Å–∞–º–æ–µ ‚Äî –Ω–æ —Å —Ç–∞–π–º–µ—Ä–æ–º. 10 –º–∏–Ω—É—Ç. 5 –∑–∞–¥–∞—á. –ë–µ–∑ –ø–µ—Ä–µ—Ä—ã–≤–∞.** | –ï—Å–ª–∏ –Ω–µ —Å–ø—Ä–∞–≤–∏–ª—Å—è ‚Äî –Ω–∞—á–Ω–∏ —Å–Ω–∞—á–∞–ª–∞. |

---


